<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PerspectiveLens</title>
    <link rel="stylesheet" href="ui/design-system.css">
    <link rel="stylesheet" href="ui/pages/popup/popup.css">
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <h1 class="title">PerspectiveLens</h1>
      <button id="settings-btn" class="icon-btn" title="Settings" aria-label="Settings">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
          <path d="M12 2C12 2 10.5 2 10.5 4C10.5 6 9 6 9 6H7C7 6 5 6 5 8V10C5 10 5 11.5 3 11.5C1 11.5 1 13.5 3 13.5C5 13.5 5 15 5 15V17C5 19 7 19 7 19H9C9 19 10.5 19 10.5 21C10.5 23 12 23 12 23C12 23 13.5 23 13.5 21C13.5 19 15 19 15 19H17C19 19 19 17 19 17V15C19 15 19 13.5 21 13.5C23 13.5 23 11.5 21 11.5C19 11.5 19 10 19 10V8C19 6 17 6 17 6H15C15 6 13.5 6 13.5 4C13.5 2 12 2 12 2Z" stroke="currentColor" stroke-width="2"/>
        </svg>
      </button>
    </header>

    <!-- Main Content -->
    <main class="content">
      <!-- AI Model Selection -->
      <section class="section">
        <div class="section-header">
          <h2 class="section-title">AI Model</h2>
          <button id="refresh-status" class="icon-btn-small" title="Refresh status" aria-label="Refresh status">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 2V8M21 8H15M21 8L18 5.5C16.5 4 14.5 3 12 3C7 3 3 7 3 12C3 17 7 21 12 21C15.5 21 18.5 19 20 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>

        <!-- Model Selector Tabs -->
        <div class="model-tabs">
          <button id="tab-nano" class="model-tab" data-model="nano">
            <span class="tab-label">Gemini Nano</span>
            <span class="tab-badge">Local</span>
          </button>
          <button id="tab-api" class="model-tab active" data-model="api">
            <span class="tab-label">API Models</span>
            <span class="tab-badge">Cloud</span>
          </button>
        </div>

        <!-- Gemini Nano Status Card -->
        <div id="nano-card" class="status-card" style="display: none;">
          <div class="status-row">
            <span class="status-label">Status</span>
            <div class="status-with-action">
              <div class="status-value" id="nano-status">
                <span class="spinner"></span>
                <span>Checking...</span>
              </div>
            </div>
          </div>

          <!-- Download Progress (hidden by default) -->
          <div class="progress-container" id="nano-progress" style="display: none;">
            <div class="progress-bar">
              <div class="progress-fill" id="nano-progress-fill" style="width: 0%"></div>
            </div>
            <div class="progress-info">
              <span id="nano-progress-percent">0%</span>
              <span id="nano-progress-size">0 MB / 1.7 GB</span>
            </div>
          </div>

          <!-- Download Button (hidden by default) -->
          <button id="nano-download-btn" class="btn-primary" style="display: none;">
            Download AI Model
          </button>
        </div>

        <!-- API Models Status Card -->
        <div id="api-card" class="status-card">
          <div class="status-row">
            <span class="status-label">Status</span>
            <div class="status-with-action">
              <div class="status-value" id="api-status">
                <span>Not Configured</span>
              </div>
              <button id="remove-key-btn" class="remove-key-btn" title="Remove API key" style="display: none;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" fill="currentColor"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- API Key Not Configured -->
          <div id="api-key-input" class="api-key-input">
            <label for="api-key" class="input-label">API Key</label>
            <div class="input-wrapper">
              <input
                type="password"
                id="api-key"
                class="text-input"
                placeholder="AIza..."
                autocomplete="off"
              >
              <button id="toggle-visibility" class="input-icon-btn" title="Show/Hide">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 5C7 5 2.73 8.11 1 12.5 2.73 16.89 7 20 12 20s9.27-3.11 11-7.5C21.27 8.11 17 5 12 5zm0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" fill="currentColor"/>
                </svg>
              </button>
            </div>

            <div class="button-row">
              <button id="save-key-btn" class="btn-primary">
                Save Key
              </button>
              <a
                href="https://aistudio.google.com/apikey"
                target="_blank"
                class="btn-link"
                rel="noopener noreferrer"
              >
                Get API Key
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z" fill="currentColor"/>
                </svg>
              </a>
            </div>

            <!-- Validation Message -->
            <div id="validation-msg" class="validation-message" style="display: none;"></div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <a href="https://github.com/IvanAmador/PerspectiveLens" target="_blank" class="footer-link" rel="noopener noreferrer">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 19C4 20.5 4 16.5 2 16M16 22V18.13C16.0375 17.6532 15.9731 17.1738 15.811 16.7238C15.6489 16.2738 15.3929 15.8634 15.06 15.52C18.2 15.17 21.5 13.98 21.5 8.52C21.4997 7.12383 20.9627 5.7812 20 4.77C20.4559 3.54851 20.4236 2.19835 19.91 1C19.91 1 18.73 0.65 16 2.48C13.708 1.85882 11.292 1.85882 9 2.48C6.27 0.65 5.09 1 5.09 1C4.57638 2.19835 4.54414 3.54851 5 4.77C4.03013 5.7887 3.49252 7.14346 3.5 8.55C3.5 13.97 6.8 15.16 9.94 15.55C9.611 15.89 9.35726 16.2954 9.19531 16.7399C9.03335 17.1844 8.96681 17.6581 9 18.13V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>View on GitHub</span>
      </a>
    </footer>

    <script src="ui/theme-manager.js"></script>
    <script src="ui/pages/popup/popup.js" type="module"></script>
  </body>
</html>
